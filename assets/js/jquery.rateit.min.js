/*! RateIt | v1.0.22 / 05/27/2014 | https://rateit.codeplex.com/license
    http://rateit.codeplex.com | Twitter: @gjunge
*/
(function(b){b.rateit={aria:{resetLabel:"reset rating",ratingLabel:"rating"}};b.fn.rateit=function(i,g){var d=1;var c={};var h="init";var f=function(j){return j.charAt(0).toUpperCase()+j.substr(1)};if(this.length===0){return this}var e=b.type(i);if(e=="object"||i===undefined||i===null){c=b.extend({},b.fn.rateit.defaults,i)}else{if(e=="string"&&i!=="reset"&&g===undefined){return this.data("rateit"+f(i))}else{if(e=="string"){h="setvalue"}}}return this.each(function(){var x=b(this);var y=function(A,B){if(B!=null){var C="aria-value"+((A=="value")?"now":A);var z=x.find(".rateit-range");if(z.attr(C)!=undefined){z.attr(C,B)}}arguments[0]="rateit"+f(A);return x.data.apply(x,arguments)};if(i=="reset"){var p=y("init");for(var k in p){x.data(k,p[k])}if(y("backingfld")){var o=b(y("backingfld"));o.val(y("value"));o.trigger("change");if(o[0].min){o[0].min=y("min")}if(o[0].max){o[0].max=y("max")}if(o[0].step){o[0].step=y("step")}}x.trigger("reset")}if(!x.hasClass("rateit")){x.addClass("rateit")}var l=x.css("direction")!="rtl";if(h=="setvalue"){if(!y("init")){throw"Can't set value before init"}if(i=="readonly"&&g==true&&!y("readonly")){x.find(".rateit-range").unbind();y("wired",false)}if(i=="value"){g=(g==null)?y("min"):Math.max(y("min"),Math.min(y("max"),g))}if(y("backingfld")){var o=b(y("backingfld"));if(i=="value"){o.val(g)}if(i=="min"&&o[0].min){o[0].min=g}if(i=="max"&&o[0].max){o[0].max=g}if(i=="step"&&o[0].step){o[0].step=g}}y(i,g)}if(!y("init")){y("min",isNaN(y("min"))?c.min:y("min"));y("max",isNaN(y("max"))?c.max:y("max"));y("step",y("step")||c.step);y("readonly",y("readonly")!==undefined?y("readonly"):c.readonly);y("resetable",y("resetable")!==undefined?y("resetable"):c.resetable);y("backingfld",y("backingfld")||c.backingfld);y("starwidth",y("starwidth")||c.starwidth);y("starheight",y("starheight")||c.starheight);y("value",Math.max(y("min"),Math.min(y("max"),(!isNaN(y("value"))?y("value"):(!isNaN(c.value)?c.value:c.min)))));y("ispreset",y("ispreset")!==undefined?y("ispreset"):c.ispreset);if(y("backingfld")){var o=b(y("backingfld")).hide();if(o.attr("disabled")||o.attr("readonly")){y("readonly",true)}if(o[0].nodeName=="INPUT"){if(o[0].type=="range"||o[0].type=="text"){y("min",parseInt(o.attr("min"))||y("min"));y("max",parseInt(o.attr("max"))||y("max"));y("step",parseInt(o.attr("step"))||y("step"))}}if(o[0].nodeName=="SELECT"&&o[0].options.length>1){y("min",(!isNaN(y("min"))?y("min"):Number(o[0].options[0].value)));y("max",Number(o[0].options[o[0].length-1].value));y("step",Number(o[0].options[1].value)-Number(o[0].options[0].value));var q=o.find("option[selected]");if(q.length==1){y("value",q.val())}}else{y("value",o.val())}}var r=x[0].nodeName=="DIV"?"div":"span";d++;var t='<button id="rateit-reset-{{index}}" type="button" data-role="none" class="rateit-reset" aria-label="'+b.rateit.aria.resetLabel+'" aria-controls="rateit-range-{{index}}"></button><{{element}} id="rateit-range-{{index}}" class="rateit-range" tabindex="0" role="slider" aria-label="'+b.rateit.aria.ratingLabel+'" aria-owns="rateit-reset-{{index}}" aria-valuemin="'+y("min")+'" aria-valuemax="'+y("max")+'" aria-valuenow="'+y("value")+'"><{{element}} class="rateit-selected" style="height:'+y("starheight")+'px"></{{element}}><{{element}} class="rateit-hover" style="height:'+y("starheight")+'px"></{{element}}></{{element}}>';x.append(t.replace(/{{index}}/gi,d).replace(/{{element}}/gi,r));if(!l){x.find(".rateit-reset").css("float","right");x.find(".rateit-selected").addClass("rateit-selected-rtl");x.find(".rateit-hover").addClass("rateit-hover-rtl")}y("init",JSON.parse(JSON.stringify(x.data())))}x.find(".rateit-selected, .rateit-hover").height(y("starheight"));var s=x.find(".rateit-range");s.width(y("starwidth")*(y("max")-y("min"))).height(y("starheight"));var n="rateit-preset"+((l)?"":"-rtl");if(y("ispreset")){x.find(".rateit-selected").addClass(n)}else{x.find(".rateit-selected").removeClass(n)}if(y("value")!=null){var m=(y("value")-y("min"))*y("starwidth");x.find(".rateit-selected").width(m)}var u=x.find(".rateit-reset");if(u.data("wired")!==true){u.bind("click",function(A){A.preventDefault();u.blur();var z=b.Event("beforereset");x.trigger(z);if(z.isDefaultPrevented()){return false}x.rateit("value",null);x.trigger("reset")}).data("wired",true)}var w=function(A,C){var B=(C.changedTouches)?C.changedTouches[0].pageX:C.pageX;var z=B-b(A).offset().left;if(!l){z=s.width()-z}if(z>s.width()){z=s.width()}if(z<0){z=0}return m=Math.ceil(z/y("starwidth")*(1/y("step")))};var j=function(C){var z=C*y("starwidth")*y("step");var A=s.find(".rateit-hover");if(A.data("width")!=z){s.find(".rateit-selected").hide();A.width(z).show().data("width",z);var B=[(C*y("step"))+y("min")];x.trigger("hover",B).trigger("over",B)}};var v=function(A){var z=b.Event("beforerated");x.trigger(z,[A]);if(z.isDefaultPrevented()){return false}y("value",A);if(y("backingfld")){b(y("backingfld")).val(A).trigger("change")}if(y("ispreset")){s.find(".rateit-selected").removeClass(n);y("ispreset",false)}s.find(".rateit-hover").hide();s.find(".rateit-selected").width(A*y("starwidth")-(y("min")*y("starwidth"))).show();x.trigger("hover",[null]).trigger("over",[null]).trigger("rated",[A]);return true};if(!y("readonly")){if(!y("resetable")){u.hide()}if(!y("wired")){s.bind("touchmove touchend",a);s.mousemove(function(z){var A=w(this,z);j(A)});s.mouseleave(function(z){s.find(".rateit-hover").hide().width(0).data("width","");x.trigger("hover",[null]).trigger("over",[null]);s.find(".rateit-selected").show()});s.mouseup(function(A){var B=w(this,A);var z=(B*y("step"))+y("min");v(z);s.blur()});s.keyup(function(z){if(z.which==38||z.which==(l?39:37)){v(Math.min(y("value")+y("step"),y("max")))}if(z.which==40||z.which==(l?37:39)){v(Math.max(y("value")-y("step"),y("min")))}});y("wired",true)}if(y("resetable")){u.show()}}else{u.hide()}s.attr("aria-readonly",y("readonly"))})};function a(e){var f=e.originalEvent.changedTouches,g=f[0],c="";switch(e.type){case"touchmove":c="mousemove";break;case"touchend":c="mouseup";break;default:return}var d=document.createEvent("MouseEvent");d.initMouseEvent(c,true,true,window,1,g.screenX,g.screenY,g.clientX,g.clientY,false,false,false,false,0,null);g.target.dispatchEvent(d);e.preventDefault()}b.fn.rateit.defaults={min:0,max:5,step:0.5,starwidth:16,starheight:16,readonly:false,resetable:true,ispreset:false};b(function(){b("div.rateit, span.rateit").rateit()})})(jQuery);